

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>brails.utils.arcgisapi_service_helper module &mdash; BRAILS++  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            BRAILS++
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rst-doc/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst-doc/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst-doc/acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst-doc/license.html">Copyright and License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst-doc/cite.html">How to Cite</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BRAILS++</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">brails.utils.arcgisapi_service_helper module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/docs/rst-code/brails.utils.arcgisapi_service_helper.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-brails.utils.arcgisapi_service_helper">
<span id="brails-utils-arcgisapi-service-helper-module"></span><h1>brails.utils.arcgisapi_service_helper module<a class="headerlink" href="#module-brails.utils.arcgisapi_service_helper" title="Link to this heading"></a></h1>
<p>This module defines a class for retrieving data from ArcGIS services APIs.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper" title="brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ArcgisAPIServiceHelper</span></code></a>(api_endpoint_url)</p></td>
<td><p>A helper class for interacting with an ArcGIS API service.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brails.utils.arcgisapi_service_helper.</span></span><span class="sig-name descname"><span class="pre">ArcgisAPIServiceHelper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_endpoint_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A helper class for interacting with an ArcGIS API service.</p>
<p>This class provides methods to query the service, fetch element counts,
split polygons into cells, and categorize cells based on their element
count.</p>
<p>This class allows users to interact with an ArcGIS API endpoint to retrieve
information about elements within specific polygons. It supports
functionality for:
- Retrieving the maximum number of elements that can be returned per query.
- Categorizing and splitting polygon cells based on the element count.
- Dividing polygons into smaller rectangular cells to ensure a balance of</p>
<blockquote>
<div><p>elements per cell.</p>
</div></blockquote>
<ul class="simple">
<li><p>Fetching specified attribute data for given cells in parallel.</p></li>
</ul>
<p>The class includes methods for making API requests with retry logic,
handling transient network errors, and parsing the responses to determine
element counts within specific regions.</p>
<dl>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>api_endpoint_url (str):</dt><dd><p>The base URL of the ArcGIS API endpoint used for requests.</p>
</dd>
<dt>max_elements_per_cell (int):</dt><dd><p>The maximum number of elements the API allows per query, fetched
from the ArcGIS service.</p>
</dd>
</dl>
</dd>
<dt>Methods:</dt><dd><dl>
<dt>fetch_max_records_per_query() -&gt; int:</dt><dd><p>Retrieves the maximum number of records returned by the API in a
single query.</p>
</dd>
<dt>categorize_and_split_cells(preliminary_cells: list[Polygon]</dt><dd><blockquote>
<div><p>) -&gt; tuple[list[Polygon], list[Polygon]]:</p>
</div></blockquote>
<p>Categorizes and splits polygons based on their element count.
Returns two lists: cells to keep and cells to split.</p>
</dd>
<dt>split_polygon_into_cells(bpoly: Polygon, element_count: int = -1,</dt><dd><blockquote>
<div><p>plot_mesh: str = ‘’) -&gt; list[Polygon]:</p>
</div></blockquote>
<p>Divides a polygon into smaller cells if the element count exceeds
the threshold.</p>
</dd>
<dt>download_attr_from_api(cell: Polygon,</dt><dd><blockquote>
<div><p>requested_fields: list[str] | str) -&gt; list:</p>
</div></blockquote>
<p>Fetches specific attribute fields from the API for a given polygon.</p>
</dd>
<dt>get_element_counts(bpoly: Polygon) -&gt; int:</dt><dd><p>Retrieves the count of elements within a given polygon’s bounding
box.</p>
</dd>
<dt>fetch_data_for_cells(final_cells: list, download_func: Callable,</dt><dd><blockquote>
<div><p>desc: str) -&gt; dict:</p>
</div></blockquote>
<p>Concurrently applies a download function to a list of cells with
progress tracking.</p>
</dd>
</dl>
</dd>
<dt>Example Usage:</dt><dd><p># Instantiate the helper class with an API endpoint:
api_helper = ArcgisAPIServiceHelper(”<a class="reference external" href="https://api.example.com/query">https://api.example.com/query</a>”)</p>
<p># Fetch the maximum number of records per query:
max_records = api_helper.fetch_max_records_per_query()</p>
<p># Split polygons into cells based on element count:
cells_to_keep, cells_to_split = api_helper.categorize_and_split_cells(</p>
<blockquote>
<div><p>preliminary_cells)</p>
</div></blockquote>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>The class assumes a uniform distribution of elements across polygons
when splitting.</p></li>
<li><p>The retry strategy uses exponential backoff to handle transient
network issues.</p></li>
<li><p>The method <cite>get_element_counts</cite> provides a count of elements within
the bounding box of a polygon, which is essential for categorizing
and splitting polygons.</p></li>
</ul>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If an invalid Polygon or parameter is passed to a method.
NotImplementedError: If the requested functionality is not supported
by the API.
HTTPError: If the HTTP request fails after retries.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.categorize_and_split_cells">
<span class="sig-name descname"><span class="pre">categorize_and_split_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preliminary_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Polygon</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Polygon</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Polygon</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.categorize_and_split_cells" title="Link to this definition"></a></dt>
<dd><p>Categorize/split a list of polygon cells based on their element count.</p>
<p>This method processes a list of polygons (preliminary_cells) by first
obtaining the number of elements contained within each polygon. If a
polygon contains more elements than the specified maximum allowed per
cell (max_elements_per_cell), the polygon is split into smaller cells.
The method returns two lists:
- A list of cells that are kept as is (those that do not exceed the</p>
<blockquote>
<div><p>element threshold).</p>
</div></blockquote>
<ul class="simple">
<li><p>A list of split cells (those that exceeded the element threshold).</p></li>
</ul>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>preliminary_cells (list[Polygon]):</dt><dd><p>A list of Shapely Polygon objects representing the preliminary
cells to be processed.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: A tuple containing two lists of Polygon objects:</dt><dd><ul class="simple">
<li><p>The first list contains the cells to keep (those with
elements &lt;= max_elements_per_cell).</p></li>
<li><p>The second list contains the split cells (those with
elements &gt; max_elements_per_cell).</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.download_all_attr_for_region">
<span class="sig-name descname"><span class="pre">download_all_attr_for_region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">region</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_description</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Obtaining</span> <span class="pre">attributes</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">cell'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.download_all_attr_for_region" title="Link to this definition"></a></dt>
<dd><p>Download all attribute data for the specified region.</p>
<dl class="simple">
<dt>This method:</dt><dd><ul class="simple">
<li><p>Retrieves the boundary polygon of the region.</p></li>
<li><p>Splits region into smaller cells for manageable data querying.</p></li>
<li><p>Refines the mesh by recursively splitting oversized cells.</p></li>
<li><p>Optionally plots the final mesh.</p></li>
<li><p>Downloads data (e.g., bridge attributes) for each cell using a
provided data-fetching function.</p></li>
</ul>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>region:</dt><dd><p>A Region object that provides a <cite>.get_boundary()</cite> method
returning a polygon, region name, and optional OSM ID.</p>
</dd>
<dt>plot_cells (bool, optional):</dt><dd><p>If True, generates and saves a visualization of the final
meshed cells.</p>
</dd>
<dt>task_description (str, optional):</dt><dd><p>A message string that describes the task being performed,
passed to the data-fetching method for logging or display.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>Tuple:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>downloaded_data (Dict[Polygon, List[Dict[str, Any]]]):</dt><dd><p>Mapping from each final mesh cell polygon to a list of
attribute dictionaries (e.g., representing bridges or other
assets).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>final_cells (List[Polygon]):</dt><dd><p>List of polygons representing the final meshed cells used
for data querying.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.download_all_attr_from_api">
<span class="sig-name descname"><span class="pre">download_all_attr_from_api</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Polygon</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.download_all_attr_from_api" title="Link to this definition"></a></dt>
<dd><p>Download attribute data for a given cell using the ArcGIS API.</p>
<p>This method queries the ArcGIS API for all available attributes within
the specified polygon cell.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>cell (Polygon):</dt><dd><p>A Shapely Polygon object representing the geographic cell for
which to retrieve bridge data.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>List[Dict[str, Any]]:</dt><dd><p>A list of dictionaries, each representing the attribute data
for a bridge within the cell. Each dictionary includes
‘geometry’ and ‘attributes’ keys as returned by the ArcGIS API.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.download_attr_from_api">
<span class="sig-name descname"><span class="pre">download_attr_from_api</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Polygon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requested_fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span></span></span><a class="headerlink" href="#brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.download_attr_from_api" title="Link to this definition"></a></dt>
<dd><p>Download specified fields from the API for a given cell.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>cell (Polygon):</dt><dd><p>A Shapely Polygon object representing the area of interest.</p>
</dd>
<dt>requested_fields (list[str] or str):</dt><dd><p>A list of attribute names or the string ‘all’.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>list[dict]:</dt><dd><p>A list of features (attributes) fetched from the API.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If the input ‘cell’ is not a valid Polygon or
‘requested_fields’ is not valid.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.fetch_data_for_cells">
<span class="sig-name descname"><span class="pre">fetch_data_for_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">final_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Obtaining</span> <span class="pre">the</span> <span class="pre">attributes</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">cell'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.fetch_data_for_cells" title="Link to this definition"></a></dt>
<dd><p>Download data for a list of cells in parallel using provided function.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>final_cells (List[Any]):</dt><dd><p>List of cells to process.</p>
</dd>
<dt>download_func (Callable[[Any], Any]):</dt><dd><p>Function to download data for a single cell.</p>
</dd>
<dt>desc (str):</dt><dd><p>Description for the progress bar.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>Dict[Any, Any]:</dt><dd><p>Dictionary mapping each cell to its downloaded data
(or None if failed).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.fetch_max_records_per_query">
<span class="sig-name descname"><span class="pre">fetch_max_records_per_query</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.fetch_max_records_per_query" title="Link to this definition"></a></dt>
<dd><p>Retrieve the maximum number of records returned by the API per query.</p>
<p>This function sends a request to the specified API endpoint and parses
the response to determine the maximum number of records that can be
returned in a single query. If the API does not provide this
information or returns a value of 0, it raises an error.</p>
<dl>
<dt>Returns:</dt><dd><dl class="simple">
<dt>int:</dt><dd><p>The maximum number of elements the API allows per query.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If the API returns a value of 0 for the maximum number of
elements, indicating an issue with the API or its response.</p>
</dd>
<dt>HTTPError:</dt><dd><p>If the HTTP request fails (e.g., due to connectivity issues or
a server error).</p>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">api_tools</span> <span class="o">=</span> <span class="n">ArcgisAPIServiceHelper</span><span class="p">(</span>
<span class="go">    &quot;https://api.example.com/data/query&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_records</span> <span class="o">=</span> <span class="n">api_tools</span><span class="o">.</span><span class="n">fetch_max_records_per_query</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">max_records</span><span class="p">)</span>
<span class="go">1000</span>
</pre></div>
</div>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>The function expects the API to return a JSON response containing
a <cite>maxRecordCount</cite> key.</p></li>
<li><p>A retry strategy is implemented for the HTTPS request to handle
transient network issues.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.get_element_counts">
<span class="sig-name descname"><span class="pre">get_element_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bpoly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Polygon</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.get_element_counts" title="Link to this definition"></a></dt>
<dd><p>Get the count of elements within the bounding box of the given polygon.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>bpoly (Polygon):</dt><dd><p>The polygon marking the boundaries of a region.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>int:</dt><dd><p>The count of elements within the bounding box, or 0 if an
error occurs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.split_polygon_into_cells">
<span class="sig-name descname"><span class="pre">split_polygon_into_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bpoly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Polygon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Polygon</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#brails.utils.arcgisapi_service_helper.ArcgisAPIServiceHelper.split_polygon_into_cells" title="Link to this definition"></a></dt>
<dd><p>Divide a polygon into smaller cells based on its element count.</p>
<p>If the number of elements exceeds the specified threshold
(max_elements_per_cell), the polygon will be divided into multiple
rectangular cells with a margin of error. The grid is generated under
the assumption that the elements are uniformly distributed across the
polygon, and it can be split based on the ratio of element_count to
max_elements_per_cell to get cells that do not exceed the  max elements
specified per cellapproximate balance. Please note that, this method
does not guarantee that each cell will contain fewer than the specified
maximum number of elements.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>bpoly (Polygon):</dt><dd><p>The polygon to be split into rectangular cells.</p>
</dd>
<dt>element_count (int, optional):</dt><dd><p>The total number of elements in the polygon. If not provided,
the method will compute this using <cite>get_element_counts</cite>.</p>
</dd>
<dt>plot_mesh (str, optional):</dt><dd><p>If provided, the generated mesh will be plotted using
<cite>GeoTools.plot_polygon_cells</cite>.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>list:</dt><dd><p>A list of polygons (or bounding boxes) representing the
rectangular grid cells that cover the input polygon.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>If the element count is below or equal to
<cite>max_elements_per_cell</cite>, the entire polygon’s envelope is
returned as a single cell.</p></li>
<li><p>If the element count exceeds <cite>max_elements_per_cell</cite>, the polygon
is divided into smaller cells based on the bounding box aspect
ratio.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, fmk.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>